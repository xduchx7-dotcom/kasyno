let state = {
  players: [],
  history: [],
  vault: 0
};

// Funkcja renderująca panel
function renderAll(){
  const playersEl = document.getElementById('players');
  playersEl.innerHTML = state.players.map(p => `${p.name}: ${p.amount} zł`).join('<br>');
  
  const vaultEl = document.getElementById('vault');
  vaultEl.textContent = `Pula: ${state.vault} zł`;
}

// Funkcja do pobierania wpłat z serwera
async function fetchPayments(){
  try {
    const res = await fetch('/payments.json'); // plik z wpłatami
    const json = await res.json();

    let newVault = 0;
    state.players = json.players.map(p => {
      newVault += Number(p.amount);
      return { name: p.name, amount: Number(p.amount) };
    });
    state.vault = newVault;

    state.history = json.history || [];
    renderAll();
  } catch(err){
    console.error('Błąd pobierania wpłat:', err);
  }
}

// Co 5 sekund pobiera nowe wpłaty
setInterval(fetchPayments, 5000);
fetchPayments(); // od razu przy starcie
